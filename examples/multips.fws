// multips.fws
network {

    device servidor-web {
        mac = "AA:BB:CC:DD:EE:FF";
        ip = 192.168.1.10;         
        subnet = 192.168.1.0/24;   
        interfaces = "ppp0";
    }

    device pc-lab {
        mac = "DD:EE:FF:11:22:33";
        ip = 192.168.9.1;          
        subnet = 192.168.9.0/16;   
        interfaces = "ppp0", "wlan0", "wlan1";
    }

     // se debe definir de manera obligatoria.
     device firewall {
        mac = "00:11:22:33:44:55";
        ip = 197.168.1.1;         
        subnet = 197.168.1.0/24;   
        interfaces = "eth0", "eth1";
    }
}

packets {
    p1 : 192.168.1.222 -> 197.168.1.1 : tcp 57890 -> 22: from "ppp0" to "";
    p2 : 192.168.9.1 -> 192.168.1.10 : tcp 12121 -> 80 : from "wlan0" to "wlan1";
    p3 : 197.168.1.1 -> 8.8.8.8 : udp 22222 -> 53 : from "" to "eth1";
    p4 : 192.168.1.10 -> 192.168.9.1 : udp 56737 -> 67 : from "ppp0" to "eth2";
}

rules {
    chain INPUT {
        -srcip 192.168.1.1, 10.0.1.2 -do ACCEPT;
        -dstip 10.0.0.1, 10.0.1.2 -dstp 80 -do DROP;
        -srcsubnet 192.168.1.0/24, 10.0.0.1/16 -do REJECT;
        -default DROP;
    }
    chain FORWARD {
        -prot udp -dstp 53 -outif "eth0" -do ACCEPT ;
        -prot tcp -dstp 80,443,53,22 -inif "eth1","wlan1" -do ACCEPT ;
    }
    chain OUTPUT {
        -dstip 8.8.8.8, 1.1.1.1 -do DROP;
        -default ACCEPT;
    }

} 