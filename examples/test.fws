// test.fws

subnets {
	
	subnet LAN {
		range = 192.168.1.0/24;
		interface = "ppp0";	
	}

	subnet DMZ {
		range = 200.1.0.0/16;
		interface = "ppp1";
	}

}

devices {

	device servidor-web {
		mac = "AA:BB:CC:DD:EE:FF";
        ip = 192.168.1.10;
		subnet = LAN;
	}

	device servidor-webb {
		mac = "AA:BB:CC:DD:EE:EE";
        ip = 200.1.1.0;
		subnet = DMZ;
	}


	device firewall {
        fwmac = "00:22:CA:FE:CA:FE";
        fwip = 211.168.1.1;         
    }
	
}

packets {
    p1 : 192.168.0.111-> 211.168.1.1 : tcp 57890 -> 22: from "wlan1" to "";
    p2 : 192.168.0.111 -> 192.168.1.10 : tcp 12121 -> 80 : from "wlan1" to "ppp0";
    p3 : 211.168.1.1 -> 8.8.8.8 : udp 22222 -> 53 : from "" to "eth1";
    p4 : 192.168.1.10 -> 192.168.0.111 : udp 56737 -> 67 : from "ppp0" to "wlan1";
    p5 : 192.168.1.1 -> 8.8.8.8 : udp 9999 -> 53 : from "ppp0" to "";
}

rules {
    chain INPUT {
        -srcip 192.168.1.1 -do ACCEPT;
        -dstip 10.0.0.1 -dstp 80 -do DROP;
        -srcsubnet 192.168.1.0/24 -do REJECT;
    }
    chain FORWARD {
         -srcip 192.168.1.1, 192.168.1.2 -dstip 8.8.8.8, 127.0.0.1 -do ACCEPT;
        -prot tcp -dstp 80,443 -do ACCEPT;
        -prot udp -dstp 53 -do ACCEPT;
        -default DROP;
    }
    chain OUTPUT {
        -dstip 8.8.8.8 -do DROP;
        -default ACCEPT;
    }
}



