// test.fws

subnets {
	
	subnet LAN {
		range = 192.168.1.0/24;
		interface = "wlan1";	
	}

    subnet DMZ {
        range = 181.16.1.16/28;
        interface = "ppp0";
    }

   
}

devices {

	device pc-A {
		mac = "AA:BB:CC:DD:EE:FF";
        ip = 192.168.1.10;
		subnet = LAN;
	}

    device pc-B {
		mac = "AA:BB:CC:DA:DA:FF";
        ip = 192.168.1.15;
		subnet = LAN;
	}

	device servidor-web {
		mac = "AA:BB:CC:DD:CA:fe";
        ip = 181.16.1.19;
		subnet = DMZ;
	}

    device web-backup {
		mac = "AA:BB:CC:DD:CA:EE";
        ip = 181.16.1.20;
		subnet = DMZ;
	}

	device firewall {
        fwmac = "00:22:CA:FE:CA:FE";
        fwip = 200.1.0.0;         
    }
	
}

packets {
    p1 : 192.168.1.10 -> 200.1.0.0 : tcp 57890 -> 22: from "wlan1" to "";           // ssh request lan->firewall
    p2 : 192.168.1.10 -> 181.16.1.19 : tcp 12121 -> 80 : from "wlan1" to "ppp0";    // http request lan->dmz
    p3 : 200.1.0.0 -> 8.8.8.8 : udp 22222 -> 53 : from "" to "eth1";                // dns request firewall->internet (google)
    p4 : 181.16.1.19 -> 192.168.1.15 : udp 6800 -> 22 : from "ppp0" to "wlan1";    // ssh request DMZ->LAN
    pext: 1.1.1.1 -> 2.2.2.2 : udp 2323 -> 53 : from "erer" to "dsfs";
    pint: 192.168.1.10 -> 192.168.1.15 : udp 2323 -> 53 : from "erer" to "dsfs";
    ploopback : 192.168.1.10 -> 127.0.0.1 : tcp 533 -> 54 : from "sdfsf" to "sdfdsf";
}

rules {
    chain INPUT {
        -srcip 192.168.1.10 -do ACCEPT;
        -dstip 10.0.0.1 -dstp 80 -do DROP;
        -srcsubnet 181.16.1.16/28 -do REJECT;
    }
    chain FORWARD {
        -prot tcp -dstp 80,443 -do ACCEPT;
        -prot udp -dstp 53 -do ACCEPT;
        -default DROP;
        
    }
    chain OUTPUT {
        -dstip 8.8.8.8 -do REJECT;
        -default ACCEPT;
    }
}